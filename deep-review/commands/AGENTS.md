<!-- generated by deep-review -->
# Plugin Commands

## Purpose
Command definitions for user-facing slash commands in the deep-review plugin. Commands orchestrate agents and manage the review lifecycle.

## Key Files
| File | Purpose | Key Exports |
|------|---------|-------------|
| `full-review.md` | Main orchestrator command | Review + architecture pipeline coordination |
| `maintain-docs.md` | Documentation updater | Incremental AGENTS.md updates after code changes |

## Data Flow
`full-review.md`: User invokes → creates .deep-review/ → launches discovery (foreground) → reads batch-plan.md → first batch: launches 7 agents (5 review + architect + researcher, parallel foreground) → subsequent batches: 5 review agents → verifies all outputs → launches both synthesizers in parallel (code review + architecture) → verifies REVIEW_REPORT.md + ARCHITECTURE_REPORT.md → prints summary
`maintain-docs.md`: User invokes → git diff detects changed files → identifies affected directories → updates AGENTS.md in those dirs → validates coverage

## Dependencies
- Internal: All 10 agents (discovery, 5 review agents, architect, researcher, synthesizer, architecture-synthesizer)
- External: Git (for maintain-docs change detection), Task tool (for agent launching)

## Patterns & Conventions
- Commands have description in YAML frontmatter (no explicit tools list — inherits all)
- State management via dual files: state.json (machine), progress.md (human)
- Compaction-safe: write state before every batch, resume via re-reading state files
- Error recovery: log failures, retry once, continue with remaining work
- Progress output: print summary after each batch, final summary at end

## Configuration
No user-configurable options. Batch sizing is auto-determined by discovery agent based on repo size. Effort level should be set to max before running (`/effort max`).

## Gotchas
- full-review orchestrator NEVER reads source code directly (only metadata files)
- Auto-compaction can interrupt at any time — recovery logic required
- Review agents run as parallel foreground tasks — verify output files exist after completion
- maintain-docs uses git commands — fails if not in a git repo
- Commands cannot be nested — don't invoke /full-review from within /maintain-docs

## Testing
- Tests: Run on repos of varying sizes (small/medium/large/huge)
- Run: `/deep-review:full-review` or `/deep-review:maintain-docs`
- Gaps: No way to unit test command orchestration logic in isolation

## Boundaries
- **Always:** Write state to disk before launching review agents
- **Always:** Verify output files exist after agents complete
- **Ask first:** Changing batch sizing strategy (affects discovery agent interface)
- **Never:** Read source code in orchestrator context (context bloat)
- **Never:** Block entire review on single agent failure (log and continue)
